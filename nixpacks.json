{
  "$schema": "https://nixpacks.com/schema.json",
  "providers": ["node"],
  "phases": {
    "setup": {
      "nixPkgs": ["nodejs_20"]
    },
    "install": {
      "cmds": [
        "npm install --legacy-peer-deps",
        "cd frontend && npm install --legacy-peer-deps",
        "cd backend && npm install --legacy-peer-deps"
      ],
      "cacheDirectories": []
    },
    "build": {
      "cmds": [
        "cd frontend && npm run build",
        "cd backend && npm run build"
      ],
      "cacheDirectories": []
    }
  },
  "start": {
    "cmd": "NODE_ENV=production node backend/dist/server.js"
  }
}
